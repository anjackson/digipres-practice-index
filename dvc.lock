schema: '2.0'
stages:
  fetch-ipres-metadata:
    cmd: python src/fetcher.py fetch-metadata sources/ipres/index.csv sources/ipres/raw
    deps:
    - path: sources/ipres/index.csv
      hash: md5
      md5: c7bd3c494bb08dd127d8dbec91bff5c3
      size: 525
    - path: src/fetcher.py
      hash: md5
      md5: c6e26e19a291a5fe6ff1d852d19779f5
      size: 2173
  merge-ipres-metadata:
    cmd: python -m src.merger sources/ipres/raw sources/ipres/merged
    deps:
    - path: sources/ipres/raw
      hash: md5
      md5: d252e904897784dadd88b759010afa63.dir
      size: 5751666
      nfiles: 19
    - path: src/merger.py
      hash: md5
      md5: da66da30acc93dd9ad6c9a9a1462b3d6
      size: 9704
    outs:
    - path: sources/ipres/merged.csv
      hash: md5
      md5: 067e4675b111b871a078cdc5e78f6110
      size: 1360822
    - path: sources/ipres/merged.jsonl
      hash: md5
      md5: deed4231087cdea176092c4381e2c57a
      size: 1586597
  generate-sqlite:
    cmd:
    - sqlite-utils insert practice.db publications sources/ipres/merged.jsonl --nl
    - sqlite-utils enable-fts practice.db publications title creators abstract keywords
      institutions type
    deps:
    - path: sources/ipres/merged.jsonl
      hash: md5
      md5: deed4231087cdea176092c4381e2c57a
      size: 1586597
    outs:
    - path: practice.db
      hash: md5
      md5: 60141ff8a8a4f379168d0352ba94b786
      size: 2433024
  generate-markdown:
    cmd:
    - rm -f ../publications/ipres/ipres-*/papers/*.md
    - python -m src.pubmaker sources/ipres/merged.jsonl ../publications/ipres
    deps:
    - path: sources/ipres/merged.jsonl
      hash: md5
      md5: deed4231087cdea176092c4381e2c57a
      size: 1586597
  fetch-phaidra-metadata:
    cmd: python src/fetcher.py fetch-metadata sources/ipres/index.csv sources/ipres/raw
    deps:
    - path: sources/ipres/index.csv
      hash: md5
      md5: c7bd3c494bb08dd127d8dbec91bff5c3
      size: 525
    - path: src/fetcher.py
      hash: md5
      md5: c6e26e19a291a5fe6ff1d852d19779f5
      size: 2173
  fetch-ideals-metadata:
    cmd: python src/fetcher-ideals.py sources/ipres/raw/ipres2023.ideals.jsonl
    deps:
    - path: src/fetcher-ideals.py
      hash: md5
      md5: ca711b4fdba2aaa122007196b625fa84
      size: 2016
