schema: '2.0'
stages:
  fetch-ipres-metadata:
    cmd: python src/fetcher.py fetch-metadata sources/ipres/index.csv sources/ipres/raw
    deps:
    - path: sources/ipres/index.csv
      hash: md5
      md5: 0e37d0d4644add2674131114612774e7
      size: 593
    - path: src/fetcher.py
      hash: md5
      md5: 91bd53fa20254115d1c0127221f2914e
      size: 2152
  merge-ipres-metadata:
    cmd: python src/merger.py sources/ipres/raw sources/ipres/merged
    deps:
    - path: sources/ipres/raw
      hash: md5
      md5: 01637efb89577b986672b3cf0ae1e1a0.dir
      size: 5731282
      nfiles: 19
    - path: src/merger.py
      hash: md5
      md5: d8c0572f374e1d7d3f23a384e53b6ec5
      size: 4479
    outs:
    - path: sources/ipres/merged.csv
      hash: md5
      md5: d80e059d3e46b267ef3aef692e88fae3
      size: 1192796
    - path: sources/ipres/merged.jsonl
      hash: md5
      md5: bbb872497abd05ef3d96b73f69a89a56
      size: 1391901
  generate-sqlite:
    cmd:
    - sqlite-utils insert practice.db publications sources/ipres/merged.jsonl --nl
    - sqlite-utils enable-fts practice.db publications title creators abstract
    deps:
    - path: sources/ipres/merged.jsonl
      hash: md5
      md5: bbb872497abd05ef3d96b73f69a89a56
      size: 1391901
    outs:
    - path: practice.db
      hash: md5
      md5: d9983401122659ab88c268701715f522
      size: 2084864
