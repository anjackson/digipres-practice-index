schema: '2.0'
stages:
  fetch-ipres-metadata:
    cmd: python src/fetcher.py fetch-metadata sources/ipres/index.csv sources/ipres/raw
    deps:
    - path: sources/ipres/index.csv
      hash: md5
      md5: c7bd3c494bb08dd127d8dbec91bff5c3
      size: 525
    - path: src/fetcher.py
      hash: md5
      md5: c6e26e19a291a5fe6ff1d852d19779f5
      size: 2173
  merge-ipres-metadata:
    cmd: python src/merger.py sources/ipres/raw sources/ipres/merged
    deps:
    - path: sources/ipres/raw
      hash: md5
      md5: 770d81f9fd139664df16a19c8970b2e3.dir
      size: 5727546
      nfiles: 19
    - path: src/merger.py
      hash: md5
      md5: 6bb332654e4407601a156673f875a5c9
      size: 4708
    outs:
    - path: sources/ipres/merged.csv
      hash: md5
      md5: a7e09fa3d215a67339ae4366b2e20f55
      size: 1099250
    - path: sources/ipres/merged.jsonl
      hash: md5
      md5: 5d439afd07e21eed1fcd5a4ff314f8a2
      size: 1231949
  generate-sqlite:
    cmd:
    - sqlite-utils insert practice.db publications sources/ipres/merged.jsonl --nl
    - sqlite-utils enable-fts practice.db publications title creators abstract
    deps:
    - path: sources/ipres/merged.jsonl
      hash: md5
      md5: 5d439afd07e21eed1fcd5a4ff314f8a2
      size: 1231949
    outs:
    - path: practice.db
      hash: md5
      md5: 4813fd27852148eeafa049f89214b606
      size: 1966080
